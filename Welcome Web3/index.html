<!DOCTYPE html>
<html lang="en-US">
  <head prefix="og: https://ogp.me/ns#">
    <meta charset="utf-8" />
    <meta name="generator" content="gh:importantimport/urara" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="manifest" crossorigin="use-credentials" href="/manifest.webmanifest" />
    <link rel="alternate" type="application/feed+json" href="/feed.json" />
    <link rel="alternate" type="application/atom+xml" href="/atom.xml" />
    <link rel="sitemap" type="application/xml" href="/sitemap.xml" />
    <meta http-equiv="content-security-policy" content="">
		<link href="../_app/immutable/assets/_layout-b218e44d.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/start-953e678a.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index-9671d79c.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/singletons-626dbfc1.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper-41c905a7.js">
		<link rel="modulepreload" href="../_app/immutable/components/pages/_layout.svelte-85a4a596.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/title-4a6e1efe.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/posts-46a83d82.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/icon-2f57f763.js">
		<link rel="modulepreload" href="../_app/immutable/modules/pages/_layout.ts-495f1f70.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/_layout-d091a1a0.js">
		<link rel="modulepreload" href="../_app/immutable/components/pages/Welcome Web3/_page.svelte.md-d6ab1b8e.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/post_layout-598cb8fb.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/post_card-d26ac490.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/footer-0ff8b803.js"><title>Welcome Web3 | Home</title><!-- HEAD_svelte-1592q3p_START --><!-- HEAD_svelte-1592q3p_END --><!-- HEAD_svelte-1kxdj3d_START --><link rel="shortcut icon" href="https://urara-demo.netlify.app/favicon.png" sizes="48x48" type="image/png"><link rel="apple-touch-icon" href="https://urara-demo.netlify.app/assets/any@180.png" sizes="180x180" type="image/png"><link rel="icon" href="https://urara-demo.netlify.app/assets/any@192.png" sizes="192x192" type="image/png"><!-- HEAD_svelte-1kxdj3d_END --><!-- HEAD_svelte-1g590ms_START --><meta name="theme-color"><!-- HEAD_svelte-1g590ms_END --><!-- HEAD_svelte-abrfj_START --><meta name="author" content="Saikat Karmakar"><link rel="canonical" href="https://urara-demo.netlify.app/Welcome Web3">
    
    <meta name="keywords" content="ctf, web3, nahamcon EU ctf 22">
    <!-- HEAD_svelte-abrfj_END --><!-- HEAD_svelte-1y1uq0g_START --><meta property="og:site_name" content="Home"><meta property="og:locale" content="en-US"><meta property="og:type" content="article">
    <meta property="og:title" content="Welcome Web3">
    
    <meta property="og:image" content="https://urara-demo.netlify.app/assets/info.png">
      <meta name="twitter:card" content="summary_large_image">
    <meta property="article:tag" content="ctf"><meta property="article:tag" content="web3"><meta property="article:tag" content="nahamcon EU ctf 22">
    <meta property="og:url" content="https://urara-demo.netlify.app/Welcome Web3">
    <meta property="article:author" content="Saikat Karmakar">
    <meta property="article:published_time" content="2022-12-19T00:00:00.000Z">
    <meta property="article:modified_time" content="2022-12-19T00:00:00.000Z"><!-- HEAD_svelte-1y1uq0g_END -->
  </head>
  <body itemscope itemtype="https://schema.org/WebPage">
    










<header id="header" class="fixed z-50 w-screen transition-all duration-500 ease-in-out border-b-2 border-transparent max-h-[4.125rem] false"><div class="navbar"><div class="navbar-start">

<div class="dropdown lg:hidden"><label for="navbar-dropdown" tabindex="0" class="btn btn-square btn-ghost"><span class="i-heroicons-outline-menu-alt-1"></span></label>
  <ul id="navbar-dropdown" tabindex="0" class="menu menu-compact dropdown-content bg-base-100 text-base-content shadow-lg rounded-box min-w-max max-w-52 p-2"><li><a data-sveltekit-prefetch href="/Welcome Web3">Welcome Web3 Writeup</a>
        </li></ul></div>
<div class="swap order-last hidden lg:inline-grid"><button class="swap-on btn btn-ghost text-base font-normal normal-case transition-all duration-200 hidden"></button>
  <ul class="swap-off menu menu-horizontal p-0"><li><a data-sveltekit-prefetch class="!rounded-btn" href="/Welcome Web3">Welcome Web3 Writeup</a>
        </li></ul></div>
        <a href="/" data-sveltekit-prefetch class="btn btn-ghost normal-case text-lg">Home</a></div>
      <div class="navbar-end">
        <div id="change-theme" class="dropdown dropdown-end"><div tabindex="0" class="btn btn-square btn-ghost"><span class="i-heroicons-outline-color-swatch"></span></div>
          <ul tabindex="0" class="flex flex-nowrap shadow-2xl menu dropdown-content bg-base-100 text-base-content rounded-box w-52 p-2 gap-2 overflow-y-auto max-h-[21.5rem]"><button data-theme="cmyk" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üñ® Light</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="dracula" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üßõ Dark</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="valentine" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üå∏ Valentine</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="aqua" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üí¶ Aqua</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="synthwave" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üåÉ Synthwave</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="night" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üåÉ Night</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="lofi" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üé∂ Lo-Fi</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="lemonade" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üçã Lemonade</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="cupcake" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üßÅ Cupcake</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="garden" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üè° Garden</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="retro" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üåá Retro</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="black" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üñ§ Black</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button></ul></div></div></div></header>

<button id="totop" aria-label="scroll to top" class="fixed grid group btn btn-circle btn-lg border-none backdrop-blur bottom-6 right-6 z-50 duration-500 ease-in-out btn-ghost bg-base-100/30 md:bg-base-200/30 translate-y-24"><div class="radial-progress text-accent transition-all duration-500 ease-in-out group-hover:text-accent-focus col-start-1 row-start-1" style="--size:4rem; --thickness: 0.25rem; --value:undefined;"></div>
  <div class="border-4 border-base-content/10 group-hover:border-transparent col-start-1 row-start-1 rounded-full w-full h-full p-4 grid duration-500 ease-in-out"><span class="i-heroicons-solid-chevron-up !w-6 !h-6"></span></div></button>

<div class="bg-base-100 md:bg-base-200 min-h-screen pt-16 md:pb-8 lg:pb-16">



<div class="flex flex-col flex-nowrap justify-center xl:flex-row xl:flex-wrap"><div class="flex-1 w-full max-w-screen-md order-first ease-out transform mx-auto xl:mr-0"></div>
  <div class="flex-1 w-full max-w-screen-md xl:order-last ease-out transform mx-auto xl:mr-0"></div>
  <div class="flex-none w-full max-w-screen-md mx-auto xl:mx-0"><article itemscope itemtype="https://schema.org/BlogPosting" itemprop="blogPost" class="h-entry card bg-base-100 rounded-none md:rounded-box md:shadow-xl overflow-hidden z-10 md:mb-8 lg:mb-16">
  
  
  <div class="card-body gap-0 "><div class="flex flex-col gap-2"><figure class="md:order-last rounded-box shadow-xl mb-4 flex-col gap-2 -mx-4 -mt-8 md:mt-0"><img src="/assets/info.png" alt="/assets/info.png" class="u-featured" loading="lazy" decoding="async"></figure>
      <div class="flex font-semibold gap-1.5"><a rel="author" class="opacity-75 hover:opacity-100 hover:text-primary duration-500 ease-in-out p-author h-card" href="https://urara-demo.netlify.app">Saikat Karmakar</a>
  <span class="opacity-50">/</span>
  <a href="/Welcome Web3" class="u-url u-uid swap group/time"><time class="group-hover/time:opacity-0 font-semibold opacity-75 duration-500 ease-in-out mr-auto dt-published" datetime="2022-12-19T00:00:00.000Z" itemprop="datePublished">Monday, Dec 19, 2022</time>
    <time class="opacity-0 group-hover/time:opacity-100 font-semibold text-primary duration-500 ease-in-out mr-auto dt-updated" datetime="2022-12-19T00:00:00.000Z" itemprop="dateModified">Monday, Dec 19, 2022</time></a></div>
      <h1 itemprop="name headline" class="card-title text-3xl mb-8 p-name">Welcome Web3</h1>
      </div>
    <main itemprop="articleBody" class="urara-prose prose e-content"><p><a href="https://github.com/Aviksaikat/WalkThroughs/tree/master/nahamcon_EU_22/web3/Welcome_DONE" rel="nofollow noopener noreferrer external" target="_blank">Challenge Code</a></p>
<ul><li>So we have the challenge file in the <a href="https://github.com/Aviksaikat/WalkThroughs/tree/master/nahamcon_EU_22/web3/Welcome_DONE" rel="nofollow noopener noreferrer external" target="_blank">eth_welcome.zip</a> file. As after extracting we have the following files</li></ul>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">%</span><span style="color: #EEFFFF"> tree</span></div><div class='line'><span style="color: #89DDFF">.</span></div><div class='line'><span style="color: #EEFFFF">‚îú‚îÄ‚îÄ contracts</span></div><div class='line'><span style="color: #EEFFFF">‚îÇ¬†¬† ‚îî‚îÄ‚îÄ Welcome</span><span style="color: #89DDFF">.</span><span style="color: #F07178">sol</span></div><div class='line'><span style="color: #EEFFFF">‚îú‚îÄ‚îÄ eth_welcome</span><span style="color: #89DDFF">.</span><span style="color: #F07178">zip</span></div><div class='line'><span style="color: #EEFFFF">‚îú‚îÄ‚îÄ interfaces</span></div><div class='line'><span style="color: #EEFFFF">‚îî‚îÄ‚îÄ scripts</span></div><div class='line'><span style="color: #EEFFFF">    ‚îî‚îÄ‚îÄ challenge</span><span style="color: #89DDFF">.</span><span style="color: #F07178">py</span></div><div class='line'></div><div class='line'><span style="color: #F78C6C">3</span><span style="color: #EEFFFF"> directories</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">3</span><span style="color: #EEFFFF"> files</span></div><div class='line'></div></code></div></pre><!-- HTML_TAG_END -->
<ul><li><p>Authors used <a href="https://eth-brownie.readthedocs.io/en/stable/python-package.html" rel="nofollow noopener noreferrer external" target="_blank">brownie</a> framework setting up this CTF challenges. So we can use this dir structure directly for our testing. So we have the target contract <code>Welcome.sol</code> &amp; <code>challenge.py</code> to check what are the requirements to solve this CTF, because there is no flag for these challenges. Instead when we have to use the given RPC url to submit our solution. So let‚Äôs get started. </p></li>
<li><p>So let‚Äôs start by reading the <code>challenge.py</code> file. </p></li></ul>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> brownie </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">*</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">deploy</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">state</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> deployer</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> player</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">    Welcome</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">deploy</span><span style="color: #89DDFF">(&#123;</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">from</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">:</span><span style="color: #82AAFF"> deployer</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">]&#125;)</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">solved</span><span style="color: #89DDFF">():</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> Welcome</span><span style="color: #89DDFF">[-</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">].</span><span style="color: #82AAFF">balance</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">True,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Solved!</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">else</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">False,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Need more coins!</span><span style="color: #89DDFF">"</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">CONFIG </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #546E7A"># "RPC": '',</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #546E7A"># "BLOCK_NUMBER": '',</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #546E7A"># 'FLAGS': '',</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">MNEMONIC</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">test test test test test test test test test test test junk</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #546E7A"># 'RUNNABLES': [],</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">ALLOWED_RPC_METHODS</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[]</span></div><div class='line'><span style="color: #89DDFF">&#125;</span></div><div class='line'></div></code></div></pre><!-- HTML_TAG_END -->
<ul><li><p>So we have 2 functions; <code>deploy</code> &amp; <code>solved</code>. By the names you can understand what they do. So let‚Äôs skip the deploy one &amp; see the <code>solved()</code>.</p></li>
<li><p>It‚Äôs simple <code>if Welcome[-1].balance() &gt; 0:</code> checks wether the balance of the contract is more than 0 or not. The <code>-1</code> indicates take the latest deployed contract instance. And lastly we have a <code>CONFIG</code> dictionary which has the <code>mnemonic</code> i.e. our private key for the given wallet. We can use this address to solve the challenge.</p></li>
<li><p>So it‚Äôs simple send money to the contract &amp; make it‚Äôs balance more than <code>0</code> &amp; solve the challenge. Hmmm how can we do that. Let‚Äôs look at the contract now.</p></li>
<li><p><code>Welcome.sol</code></p></li></ul>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" js="true"><div class="language-id">js</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">pragma solidity </span><span style="color: #89DDFF">^</span><span style="color: #F78C6C">0.8</span><span style="color: #89DDFF">.</span><span style="color: #F78C6C">10</span><span style="color: #89DDFF">;</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">contract Welcome </span><span style="color: #89DDFF">&#123;</span></div><div class='line'></div><div class='line'><span style="color: #F07178">    </span><span style="color: #82AAFF">receive</span><span style="color: #F07178">() </span><span style="color: #EEFFFF">external</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">payable</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">        </span></div><div class='line'><span style="color: #F07178">    </span><span style="color: #89DDFF">&#125;</span></div><div class='line'></div><div class='line'><span style="color: #89DDFF">&#125;</span></div></code></div></pre><!-- HTML_TAG_END -->
<ul><li><p>So the first line is the <code>pragma solidity</code> which defines the compiler version we should be using for this contract. Next, we have the <code>contract</code> keyword with the contract name <code>Welcome</code> &amp; inside this contract there is a odd function/method i.e. called <code>receive()</code> &amp; it has no body. Odd‚Ä¶hmmm‚Ä¶ not quite. Actually it‚Äôs pretty common in solidity. </p></li>
<li><p>This <code>receive()</code> fu. is called a <code>Fallback function</code>. Wait. What are those!!??. </p></li>
<li><p>According to Learn Ethereum [Book] - O‚ÄôReilly, <code>A fallback function is an unnamed external function without any input or output parameters. EVM executes the fallback function on a contract if none of the other functions match the intended function calls </code>. </p></li>
<li><p>In terms of english, a fallback function is fn. which is used to receive tokens (ETH or anything) from other sources (other contract/wallet etc.). It has no body, it doesn‚Äôt take any input parameter and it doesn‚Äôt return anything. This method is the latest way of receiving money(tokens) from other sources. In older version of solidity this can be done by just specifying the <code>function</code> keyword like this <code>function() external payable {}</code>. </p></li>
<li><p>The <code>external</code> specifies that the fn. can be called from other contracts or wallets. </p></li>
<li><p>Lastly the <code>payable</code> keyword. It‚Äôs very important as without this keyword this contract can‚Äôt receive any payments. It tells the <code>EVM</code> that this function is capable of receiving eth.</p></li></ul>
<ul><li>Ok let‚Äôs make our attack script. We have started our instance. We can run this locally as well because by the time I publish this writeup the site will be pretty much taken down. </li></ul>
<p><img src="/assets/challenge_start.png" alt="/assets/challenge_start.png" class="rounded-lg my-2" loading="lazy" decoding="async"></p>
<ul><li>To run the contract in the challenge environment from brownie fist we have to add it to the <code>brownie networks list</code>. To do this we have to use this command. To know more always read the docs.</li></ul>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">brownie networks add Ethereum </span><span style="color: #F78C6C">1337</span><span style="color: #EEFFFF"> host</span><span style="color: #89DDFF">=&lt;</span><span style="color: #EEFFFF">RPC URL</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF"> chainid</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">1</span></div></code></div></pre><!-- HTML_TAG_END -->
<ul><li><p>And we‚Äôll get something like this.
<img src="/assets/networks-add.png" alt="/assets/networks-add.png" class="rounded-lg my-2" loading="lazy" decoding="async"></p></li>
<li><p>Cool let‚Äôs start writing our script.</p></li></ul>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #546E7A">#!/usr/bin/python3</span></div><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> brownie </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">*</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">solved</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">welcome_address</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> Welcome</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">at</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">welcome_address</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">balance</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Solved!</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">else</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Need more coins!</span><span style="color: #89DDFF">"</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">main</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">welcome_address</span><span style="color: #89DDFF">=None):</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> welcome_address</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #546E7A"># print("Yo")</span></div><div class='line'><span style="color: #EEFFFF">        CONFIG </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">RPC</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">https://ctf.nahamcon.com/challenge/39/4b1c3f26-f849-4ead-b563-6ddc5f5d477b</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #546E7A"># "BLOCK_NUMBER": '',</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #546E7A"># 'FLAGS': '',</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">MNEMONIC</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">test test test test test test test test test test test junk</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #546E7A"># 'RUNNABLES': [],</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">ALLOWED_RPC_METHODS</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[],</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #546E7A"># welcome_address = "0x0cB8C2Fe5f94B3b9a569Df43a9155AC008c9884b"</span></div><div class='line'><span style="color: #EEFFFF">        attacker </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> accounts</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">from_mnemonic</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">CONFIG</span><span style="color: #89DDFF">[</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">MNEMONIC</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">])</span></div><div class='line'><span style="color: #EEFFFF">        tx </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> attacker</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">transfer</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">to</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">welcome_address</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #EEFFFF">amount</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">0.01 ether</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        tx</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">wait</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">"Solved: </span><span style="color: #82AAFF">&#123;solved</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">welcome_address</span><span style="color: #89DDFF">)</span><span style="color: #82AAFF">&#125;</span><span style="color: #C3E88D">"</span><span style="color: #89DDFF">)</span></div></code></div></pre><!-- HTML_TAG_END -->
<ul><li>So we have defined our <code>main</code> fn. There is if part because I‚Äôm going to pass the contract address as a command line argument to make it more generic you can just uncomment the <code>welcome_address</code> variable. The <code>else</code> part is to test the contract locally. We‚Äôll get into in later. We have the <code>CONFIG</code> dictionary which has the <code>mnemonic</code> key.</li>
<li>Next loads the wallet from the mnemonic. <code>accounts.from_mnemonic(CONFIG[&quot;MNEMONIC&quot;])</code>.So we‚Äôre pulling the <code>mnemonic</code> from <code>CONFIG</code> dictionary &amp; saving it as the <code>attacker</code> variable.</li></ul>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">tx </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> attacker</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">transfer</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">to</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">welcome_address</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #EEFFFF">amount</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">0.1 ether</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">tx</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">wait</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">)</span></div></code></div></pre><!-- HTML_TAG_END -->
<ul><li><p>Next we‚Äôre sending <code>0.1 ETH</code> from our wallet to the target contract &amp; the next line is not necessary but we‚Äôre waiting for the transaction.</p></li>
<li><p>Lastly we‚Äôre calling the <code>solved()</code> fn. to get check wether all these code makes any sense or not. </p></li>
<li><p>Now let‚Äôs do the magic. To run we have to use the following command.</p></li></ul>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">brownie run scripts</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">attack</span><span style="color: #89DDFF">.</span><span style="color: #F07178">py</span><span style="color: #EEFFFF"> main </span><span style="color: #89DDFF">&lt;</span><span style="color: #EEFFFF">address of the contract</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF"> --network </span><span style="color: #89DDFF">&lt;</span><span style="color: #EEFFFF">network name</span><span style="color: #89DDFF">&gt;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p><img src="/assets/run.png" alt="/assets/run.png" class="rounded-lg my-2" loading="lazy" decoding="async"></p>
<ul><li><p>Done! We have solved the challenge!!!</p></li>
<li><p>Now the bonus part. If we want to test this locally we can do this with just a few tweaks. Let‚Äôs see how we can do that. So to do that fist we have to deploy the contract locally. So let‚Äôs add the <code>else</code>. </p></li></ul>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">deploy_local</span><span style="color: #89DDFF">():</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> Welcome</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">deploy</span><span style="color: #89DDFF">(&#123;</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">from</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">:</span><span style="color: #82AAFF"> accounts</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">]&#125;)</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">[</span><span style="color: #EEFFFF">...</span><span style="color: #89DDFF">]</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">else</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">        welcome </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">deploy_local</span><span style="color: #89DDFF">()</span></div><div class='line'><span style="color: #EEFFFF">        welcome_address </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> welcome</span><span style="color: #89DDFF">.</span><span style="color: #F07178">address</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #546E7A"># print(address)</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #546E7A"># send ether forcefully</span></div><div class='line'><span style="color: #EEFFFF">        attacker </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> accounts</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">]</span></div><div class='line'><span style="color: #EEFFFF">        tx </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> attacker</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">transfer</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">to</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">welcome_address</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #EEFFFF">amount</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">0.001 ether</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        tx</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">wait</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">"Solved: </span><span style="color: #82AAFF">&#123;solved_locally</span><span style="color: #89DDFF">()</span><span style="color: #82AAFF">&#125;</span><span style="color: #C3E88D">"</span><span style="color: #89DDFF">)</span></div></code></div></pre><!-- HTML_TAG_END -->
<ul><li><p>The <code>deploy_local</code> fn. is going to deploy the contract locally &amp; this is the syntax to do that. Notice the <code>{&quot;from&quot;: accounts[0]}</code> which is the defined way of deploying smart contracts in brownie. We‚Äôre specifying the account from which the contract is being deployed. <code>accounts</code> is a list provided by brownie that contains 10 test accounts indexed from 0-9. We can use any of them. Then we‚Äôre setting the address of the deployed contract to the <code>welcome_address</code> variable &amp; we‚Äôre using the 2nd test account as the attacker account. It can be anything other than the fist account otherwise it‚Äôs worthless if we‚Äôre the admin then everything is pointless. Apart from that everything is same. So the final script looks like this.</p></li>
<li><p><code>attack.py</code></p></li></ul>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #546E7A">#!/usr/bin/python3</span></div><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> brownie </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">*</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">deploy</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">state</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> deployer</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> player</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">    Welcome</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">deploy</span><span style="color: #89DDFF">(&#123;</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">from</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">:</span><span style="color: #82AAFF"> deployer</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">]&#125;)</span></div><div class='line'></div><div class='line'></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">solved</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">welcome_address</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> Welcome</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">at</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">welcome_address</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">balance</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Solved!</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">else</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Need more coins!</span><span style="color: #89DDFF">"</span></div><div class='line'></div><div class='line'><span style="color: #546E7A"># ------------------------------------------------</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">deploy_local</span><span style="color: #89DDFF">():</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> Welcome</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">deploy</span><span style="color: #89DDFF">(&#123;</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">from</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">:</span><span style="color: #82AAFF"> accounts</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">]&#125;)</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">solved_locally</span><span style="color: #89DDFF">():</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> Welcome</span><span style="color: #89DDFF">[-</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">].</span><span style="color: #82AAFF">balance</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">True,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Solved!</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">else</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">False,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Need more coins!</span><span style="color: #89DDFF">"</span></div><div class='line'></div><div class='line'></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">main</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">welcome_address</span><span style="color: #89DDFF">=None):</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> welcome_address</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #546E7A"># print("Yo")</span></div><div class='line'><span style="color: #EEFFFF">        CONFIG </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">RPC</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">https://ctf.nahamcon.com/challenge/39/4b1c3f26-f849-4ead-b563-6ddc5f5d477b</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #546E7A"># "BLOCK_NUMBER": '',</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #546E7A"># 'FLAGS': '',</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">MNEMONIC</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">test test test test test test test test test test test junk</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #546E7A"># 'RUNNABLES': [],</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">ALLOWED_RPC_METHODS</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[],</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #546E7A"># welcome_address = "0x0cB8C2Fe5f94B3b9a569Df43a9155AC008c9884b"</span></div><div class='line'><span style="color: #EEFFFF">        attacker </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> accounts</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">from_mnemonic</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">CONFIG</span><span style="color: #89DDFF">[</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">MNEMONIC</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">])</span></div><div class='line'><span style="color: #EEFFFF">        tx </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> attacker</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">transfer</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">to</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">welcome_address</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #EEFFFF">amount</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">0.01 ether</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        tx</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">wait</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">"</span><span style="color: #82AAFF">&#123;solved</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">welcome_address</span><span style="color: #89DDFF">)</span><span style="color: #82AAFF">&#125;</span><span style="color: #C3E88D">"</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">else</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">        welcome </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">deploy_local</span><span style="color: #89DDFF">()</span></div><div class='line'><span style="color: #EEFFFF">        welcome_address </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> welcome</span><span style="color: #89DDFF">.</span><span style="color: #F07178">address</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #546E7A"># print(address)</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #546E7A"># send ether forcefully</span></div><div class='line'><span style="color: #EEFFFF">        attacker </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> accounts</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">]</span></div><div class='line'><span style="color: #EEFFFF">        tx </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> attacker</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">transfer</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">to</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">welcome_address</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #EEFFFF">amount</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">0.001 ether</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        tx</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">wait</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">"Solved: </span><span style="color: #82AAFF">&#123;solved_locally</span><span style="color: #89DDFF">()</span><span style="color: #82AAFF">&#125;</span><span style="color: #C3E88D">"</span><span style="color: #89DDFF">)</span></div><div class='line'></div></code></div></pre><!-- HTML_TAG_END -->
<ul><li>We can run this as before but we don‚Äôt have to specify anything now.</li></ul>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">brownie run scripts</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">attack</span><span style="color: #89DDFF">.</span><span style="color: #F07178">py</span></div></code></div></pre><!-- HTML_TAG_END -->
<p><img src="/assets/solved.png" alt="/assets/solved.png" class="rounded-lg my-2" loading="lazy" decoding="async"></p>
<ul><li>And it‚Äôs done. I hope you liked this writeup. Thanks for reading. See ya!!</li></ul></main>
    <div class="divider mt-4 mb-0"></div>
      <div><a href="/?tags=ctf" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#ctf
          </a><a href="/?tags=web3" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#web3
          </a><a href="/?tags=nahamcon EU ctf 22" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#nahamcon EU ctf 22
          </a></div></div>
  
    </article>
    <footer id="footer" class="footer footer-center bg-base-300 text-base-content shadow-inner p-8 md:rounded-box sticky bottom-0 z-0 md:static "><div class="prose"><p><a href="/atom.xml" rel="noopener external" target="_blank">Feed</a>
          <span class="mr-1">¬∑</span><a href="/sitemap.xml" rel="noopener external" target="_blank">Sitemap</a>
          
        <br>
      Copyright ¬© 2022
      Saikat Karmakar
      <br>
      Powered by
      <a rel="noopener external" target="_blank" class="tooltip tooltip-secondary hover:text-secondary" data-tip="üå∏ [Œ¥] - Based on MDsveX & SvelteKit üå∏" href="https://github.com/importantimport/urara">Urara
      </a>
      </p></div></footer></div></div></div>


		<script type="module" data-sveltekit-hydrate="m7a5s1">
			import { start } from "../_app/immutable/start-953e678a.js";

			start({
				env: {},
				paths: {"base":"","assets":""},
				target: document.querySelector('[data-sveltekit-hydrate="m7a5s1"]').parentNode,
				version: "1671563821801",
				hydrate: {
					node_ids: [0, 3],
					data: [null,null],
					form: null
				}
			});
		</script>
	<script type="application/json" data-sveltekit-fetched data-url="/posts.json">{"status":200,"statusText":"","headers":{},"body":"[{\"title\":\"Welcome Web3\",\"image\":\"/assets/info.png\",\"created\":\"2022-12-19T00:00:00.000Z\",\"updated\":\"2022-12-19T00:00:00.000Z\",\"tags\":[\"ctf\",\"web3\",\"nahamcon EU ctf 22\"],\"flags\":[],\"slug\":\"/Welcome Web3/+page.svelte.md\",\"path\":\"/Welcome Web3\",\"toc\":false,\"type\":\"article\",\"html\":\"\"},{\"title\":\"Elements\",\"created\":\"2021-12-12T00:00:00.000Z\",\"tags\":[\"Urara\",\"Elements\"],\"flags\":[],\"updated\":\"2022-12-20T19:16:43.316Z\",\"slug\":\"/Welcome Web3/elements/+page.svelte.md\",\"path\":\"/Welcome Web3/elements\",\"toc\":[{\"depth\":2,\"title\":\"Headings\",\"slug\":\"headings\"},{\"depth\":3,\"title\":\"Heading\",\"slug\":\"heading\"},{\"depth\":4,\"title\":\"Heading\",\"slug\":\"heading-1\"},{\"depth\":5,\"title\":\"Heading\",\"slug\":\"heading-2\"},{\"depth\":6,\"title\":\"Heading\",\"slug\":\"heading-3\"},{\"depth\":2,\"title\":\"Paragraphs\",\"slug\":\"paragraphs\"},{\"depth\":2,\"title\":\"Lists\",\"slug\":\"lists\"},{\"depth\":3,\"title\":\"Definition List (dl)\",\"slug\":\"definition-list-dl\"},{\"depth\":3,\"title\":\"Ordered List (ol)\",\"slug\":\"ordered-list-ol\"},{\"depth\":3,\"title\":\"Unordered List (ul)\",\"slug\":\"unordered-list-ul\"},{\"depth\":3,\"title\":\"Checkbox List (ul)\",\"slug\":\"checkbox-list-ul\"},{\"depth\":2,\"title\":\"Table\",\"slug\":\"table\"},{\"depth\":2,\"title\":\"Footnotes\",\"slug\":\"footnotes\"},{\"depth\":2,\"title\":\"Code\",\"slug\":\"code\"},{\"depth\":2,\"title\":\"Misc\",\"slug\":\"misc\"},{\"depth\":2,\"title\":\"Svelte Components\",\"slug\":\"svelte-components\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"ToC Disabled\",\"summary\":\"This post has disabled table of contents.\",\"created\":\"2021-12-12T00:00:00.000Z\",\"tags\":[\"Front-Matter\"],\"toc\":false,\"flags\":[],\"updated\":\"2022-12-20T19:16:43.316Z\",\"slug\":\"/Welcome Web3/toc-disabled/+page.md\",\"path\":\"/Welcome Web3/toc-disabled\",\"type\":\"article\",\"html\":\"\"}]"}</script>
  </body>
</html>
