import{S as Ot,i as Bt,s as Jt,W as at,w as A,x as T,y as C,Z as Kt,_ as Ht,f as W,t as F,z as R,$ as jt,k as r,q as c,a as p,l as s,m as l,r as h,h as a,c as f,n as u,b as Mt,D as e,E as Nt}from"../../../chunks/index-9671d79c.js";import{P as Qt}from"../../../chunks/post_layout-76c250d8.js";import{I as q}from"../../../chunks/post_card-ea1dea7e.js";function Vt(G){let t,d,m,E,i,g,v,b,we,D,H,$e,Ee,j,z,y,be,O,B,ye,ke,J,K,k,xe,M,N,Le,Ie,Q,V,x,Pe,X,Y,Ae,Te,ee,S,Ce,_,We,Fe,te,L,Re,ae,Ge,Se,Ue,re,U,Ze,w,qe,De,se,le,He,je,ne,ie,I,ze,oe,ce,Oe,Be,pe,he,P,Je,fe,ge,Ke,Me,de,me,Ne,Qe,ue,Z,Ve,$,Xe,ve;return b=new q({props:{src:"https://gitlab.com/Aviksaikat/write-ups/-/raw/main/challenges/gitlab-11.4.7/images/1.png"}}),y=new q({props:{src:"https://gitlab.com/Aviksaikat/write-ups/-/raw/main/challenges/gitlab-11.4.7/images/2.png"}}),k=new q({props:{src:"https://gitlab.com/Aviksaikat/write-ups/-/raw/main/challenges/gitlab-11.4.7/images/3.png"}}),x=new q({props:{src:"https://gitlab.com/Aviksaikat/write-ups/-/raw/main/challenges/gitlab-11.4.7/images/4.png"}}),I=new q({props:{src:"https://gitlab.com/Aviksaikat/write-ups/-/raw/main/challenges/gitlab-11.4.7/images/8.png"}}),P=new q({props:{src:"https://gitlab.com/Aviksaikat/write-ups/-/raw/main/challenges/gitlab-11.4.7/images/9.png"}}),{c(){t=r("ul"),d=r("li"),m=r("p"),E=c("For this challenge we’re running a gitlab instance locally"),i=p(),g=r("li"),v=r("p"),A(b.$$.fragment),we=p(),D=r("li"),H=r("p"),$e=c("We have registered an account and logged in"),Ee=p(),j=r("li"),z=r("p"),A(y.$$.fragment),be=p(),O=r("li"),B=r("p"),ye=c("We can check the version here as well"),ke=p(),J=r("li"),K=r("p"),A(k.$$.fragment),xe=p(),M=r("li"),N=r("p"),Le=c("If we visit the official gitlab repository & see at the commits history we can see details about the commits. We are searching for version 11.4.8 as the fix for the previous version would be there."),Ie=p(),Q=r("li"),V=r("p"),A(x.$$.fragment),Pe=p(),X=r("li"),Y=r("p"),Ae=c("There is no filtering going we can send any ipv6 url we can bypass the url check."),Te=p(),ee=r("li"),S=r("p"),Ce=c("There is a exploit "),_=r("a"),We=c("script available"),Fe=p(),te=r("li"),L=r("p"),Re=c("So this script is basically importing a new repository using an ipv6 localhost address "),ae=r("code"),Ge=c("git://[0:0:0:0:0:ffff:127.0.0.1]:6379/test/.git"),Se=c(" and sending a reverse shell as the payload"),Ue=p(),re=r("li"),U=r("p"),Ze=c("This script was not working for me so I used this "),w=r("a"),qe=c("one"),De=p(),se=r("li"),le=r("p"),He=c("Let’s run the exploit"),je=p(),ne=r("li"),ie=r("p"),A(I.$$.fragment),ze=p(),oe=r("li"),ce=r("p"),Oe=c("First step is to generate & download a reverse-shell payload & then using the second option to connect back to us"),Be=p(),pe=r("li"),he=r("p"),A(P.$$.fragment),Je=p(),fe=r("li"),ge=r("p"),Ke=c("Using the 2nd option we successfully ran got a reverse-shell"),Me=p(),de=r("li"),me=r("p"),Ne=c("This script was a bit different. First we’re creating a script which contains a reverse-shell payload & in the next step we’re executing it on the victim machine. Hence we’re getting a reverse-shell."),Qe=p(),ue=r("li"),Z=r("p"),Ve=c("All the necessary scripts can be found "),$=r("a"),Xe=c("here"),this.h()},l(o){t=s(o,"UL",{});var n=l(t);d=s(n,"LI",{});var rt=l(d);m=s(rt,"P",{});var st=l(m);E=h(st,"For this challenge we’re running a gitlab instance locally"),st.forEach(a),rt.forEach(a),i=f(n),g=s(n,"LI",{});var lt=l(g);v=s(lt,"P",{});var nt=l(v);T(b.$$.fragment,nt),nt.forEach(a),lt.forEach(a),we=f(n),D=s(n,"LI",{});var it=l(D);H=s(it,"P",{});var ot=l(H);$e=h(ot,"We have registered an account and logged in"),ot.forEach(a),it.forEach(a),Ee=f(n),j=s(n,"LI",{});var ct=l(j);z=s(ct,"P",{});var pt=l(z);T(y.$$.fragment,pt),pt.forEach(a),ct.forEach(a),be=f(n),O=s(n,"LI",{});var ht=l(O);B=s(ht,"P",{});var ft=l(B);ye=h(ft,"We can check the version here as well"),ft.forEach(a),ht.forEach(a),ke=f(n),J=s(n,"LI",{});var gt=l(J);K=s(gt,"P",{});var dt=l(K);T(k.$$.fragment,dt),dt.forEach(a),gt.forEach(a),xe=f(n),M=s(n,"LI",{});var mt=l(M);N=s(mt,"P",{});var ut=l(N);Le=h(ut,"If we visit the official gitlab repository & see at the commits history we can see details about the commits. We are searching for version 11.4.8 as the fix for the previous version would be there."),ut.forEach(a),mt.forEach(a),Ie=f(n),Q=s(n,"LI",{});var vt=l(Q);V=s(vt,"P",{});var _t=l(V);T(x.$$.fragment,_t),_t.forEach(a),vt.forEach(a),Pe=f(n),X=s(n,"LI",{});var wt=l(X);Y=s(wt,"P",{});var $t=l(Y);Ae=h($t,"There is no filtering going we can send any ipv6 url we can bypass the url check."),$t.forEach(a),wt.forEach(a),Te=f(n),ee=s(n,"LI",{});var Et=l(ee);S=s(Et,"P",{});var Ye=l(S);Ce=h(Ye,"There is a exploit "),_=s(Ye,"A",{href:!0,rel:!0,target:!0});var bt=l(_);We=h(bt,"script available"),bt.forEach(a),Ye.forEach(a),Et.forEach(a),Fe=f(n),te=s(n,"LI",{});var yt=l(te);L=s(yt,"P",{});var _e=l(L);Re=h(_e,"So this script is basically importing a new repository using an ipv6 localhost address "),ae=s(_e,"CODE",{});var kt=l(ae);Ge=h(kt,"git://[0:0:0:0:0:ffff:127.0.0.1]:6379/test/.git"),kt.forEach(a),Se=h(_e," and sending a reverse shell as the payload"),_e.forEach(a),yt.forEach(a),Ue=f(n),re=s(n,"LI",{});var xt=l(re);U=s(xt,"P",{});var et=l(U);Ze=h(et,"This script was not working for me so I used this "),w=s(et,"A",{href:!0,rel:!0,target:!0});var Lt=l(w);qe=h(Lt,"one"),Lt.forEach(a),et.forEach(a),xt.forEach(a),De=f(n),se=s(n,"LI",{});var It=l(se);le=s(It,"P",{});var Pt=l(le);He=h(Pt,"Let’s run the exploit"),Pt.forEach(a),It.forEach(a),je=f(n),ne=s(n,"LI",{});var At=l(ne);ie=s(At,"P",{});var Tt=l(ie);T(I.$$.fragment,Tt),Tt.forEach(a),At.forEach(a),ze=f(n),oe=s(n,"LI",{});var Ct=l(oe);ce=s(Ct,"P",{});var Wt=l(ce);Oe=h(Wt,"First step is to generate & download a reverse-shell payload & then using the second option to connect back to us"),Wt.forEach(a),Ct.forEach(a),Be=f(n),pe=s(n,"LI",{});var Ft=l(pe);he=s(Ft,"P",{});var Rt=l(he);T(P.$$.fragment,Rt),Rt.forEach(a),Ft.forEach(a),Je=f(n),fe=s(n,"LI",{});var Gt=l(fe);ge=s(Gt,"P",{});var St=l(ge);Ke=h(St,"Using the 2nd option we successfully ran got a reverse-shell"),St.forEach(a),Gt.forEach(a),Me=f(n),de=s(n,"LI",{});var Ut=l(de);me=s(Ut,"P",{});var Zt=l(me);Ne=h(Zt,"This script was a bit different. First we’re creating a script which contains a reverse-shell payload & in the next step we’re executing it on the victim machine. Hence we’re getting a reverse-shell."),Zt.forEach(a),Ut.forEach(a),Qe=f(n),ue=s(n,"LI",{});var qt=l(ue);Z=s(qt,"P",{});var tt=l(Z);Ve=h(tt,"All the necessary scripts can be found "),$=s(tt,"A",{href:!0,rel:!0,target:!0});var Dt=l($);Xe=h(Dt,"here"),Dt.forEach(a),tt.forEach(a),qt.forEach(a),n.forEach(a),this.h()},h(){u(_,"href","https://github.com/ctrlsam/GitLab-11.4.7-RCE/blob/master/exploit.py"),u(_,"rel","nofollow noopener noreferrer external"),u(_,"target","_blank"),u(w,"href","https://github.com/mohinparamasivam/GitLab-11.4.7-Authenticated-Remote-Code-Execution"),u(w,"rel","nofollow noopener noreferrer external"),u(w,"target","_blank"),u($,"href","https://gitlab.com/Aviksaikat/write-ups/-/tree/main/challenges/gitlab-11.4.7"),u($,"rel","nofollow noopener noreferrer external"),u($,"target","_blank")},m(o,n){Mt(o,t,n),e(t,d),e(d,m),e(m,E),e(t,i),e(t,g),e(g,v),C(b,v,null),e(t,we),e(t,D),e(D,H),e(H,$e),e(t,Ee),e(t,j),e(j,z),C(y,z,null),e(t,be),e(t,O),e(O,B),e(B,ye),e(t,ke),e(t,J),e(J,K),C(k,K,null),e(t,xe),e(t,M),e(M,N),e(N,Le),e(t,Ie),e(t,Q),e(Q,V),C(x,V,null),e(t,Pe),e(t,X),e(X,Y),e(Y,Ae),e(t,Te),e(t,ee),e(ee,S),e(S,Ce),e(S,_),e(_,We),e(t,Fe),e(t,te),e(te,L),e(L,Re),e(L,ae),e(ae,Ge),e(L,Se),e(t,Ue),e(t,re),e(re,U),e(U,Ze),e(U,w),e(w,qe),e(t,De),e(t,se),e(se,le),e(le,He),e(t,je),e(t,ne),e(ne,ie),C(I,ie,null),e(t,ze),e(t,oe),e(oe,ce),e(ce,Oe),e(t,Be),e(t,pe),e(pe,he),C(P,he,null),e(t,Je),e(t,fe),e(fe,ge),e(ge,Ke),e(t,Me),e(t,de),e(de,me),e(me,Ne),e(t,Qe),e(t,ue),e(ue,Z),e(Z,Ve),e(Z,$),e($,Xe),ve=!0},p:Nt,i(o){ve||(W(b.$$.fragment,o),W(y.$$.fragment,o),W(k.$$.fragment,o),W(x.$$.fragment,o),W(I.$$.fragment,o),W(P.$$.fragment,o),ve=!0)},o(o){F(b.$$.fragment,o),F(y.$$.fragment,o),F(k.$$.fragment,o),F(x.$$.fragment,o),F(I.$$.fragment,o),F(P.$$.fragment,o),ve=!1},d(o){o&&a(t),R(b),R(y),R(k),R(x),R(I),R(P)}}}function Xt(G){let t,d;const m=[G[0],zt];let E={$$slots:{default:[Vt]},$$scope:{ctx:G}};for(let i=0;i<m.length;i+=1)E=at(E,m[i]);return t=new Qt({props:E}),{c(){A(t.$$.fragment)},l(i){T(t.$$.fragment,i)},m(i,g){C(t,i,g),d=!0},p(i,[g]){const v=g&1?Kt(m,[g&1&&Ht(i[0]),g&0&&Ht(zt)]):{};g&2&&(v.$$scope={dirty:g,ctx:i}),t.$set(v)},i(i){d||(W(t.$$.fragment,i),d=!0)},o(i){F(t.$$.fragment,i),d=!1},d(i){R(t,i)}}}const zt={title:"Gitlab-11.4.7 Remote Code Execution(RCE) Exploitation",created:"2021-09-03T00:00:00.000Z",updated:"2022-12-19T00:00:00.000Z",tags:["gitlab","ctf","rce"],flags:[],slug:"/GitLab11.4.7-RCE/+page.svelte.md",path:"/GitLab11.4.7-RCE",toc:!1};function Yt(G,t,d){return G.$$set=m=>{d(0,t=at(at({},t),jt(m)))},t=jt(t),[t]}class ra extends Ot{constructor(t){super(),Bt(this,t,Yt,Xt,Jt,{})}}export{ra as default,zt as metadata};
